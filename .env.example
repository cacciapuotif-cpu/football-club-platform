# ============================================
# PORT CONFIGURATION (MANDATORY - READ CAREFULLY)
# ============================================
# Football Club Platform Port Assignments
# Port 3001 is RESERVED for pythonpro - DO NOT USE IT

# Frontend (Next.js)
FCP_WEB_PORT=3000          # Default: 3000 (DO NOT SET TO 3001)

# Backend API (FastAPI)
FCP_API_PORT=8000          # Default: 8000
FCP_API_PORT_ALT=8001      # Alternative: 8001

# Database (PostgreSQL)
FCP_DB_PORT=5434           # Default: 5434 (not 5432 to avoid conflicts)

# Cache (Redis)
FCP_REDIS_PORT=6381        # Default: 6381 (not 6379 to avoid conflicts)

# Reserved - DO NOT USE
PYTHONPRO_WEB_PORT=3001    # RESERVED FOR PYTHONPRO PROJECT

# ============================================
# APP CONFIGURATION
# ============================================
APP_ENV=development
APP_NAME="Football Club Platform"
API_VERSION=v1
DEBUG=true

# JWT Authentication
JWT_SECRET=change_me_to_a_long_random_string_at_least_32_chars_min
JWT_ALGORITHM=HS256
JWT_EXPIRES_MIN=30
JWT_REFRESH_EXPIRES_DAYS=7

# CORS Configuration (Frontend Access)
# CRITICAL: Must match FCP_WEB_PORT (default 3000). NEVER use port 3001 (reserved for pythonpro)
# Format: comma-separated list of allowed origins
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8000
CORS_ALLOW_CREDENTIALS=true
CORS_MAX_AGE=3600

# Frontend URL (for emails, notifications, webhooks)
FRONTEND_URL=http://localhost:3000

# Logging & Workers
LOG_LEVEL=INFO
WORKERS=4

# ============================================
# DATABASE
# ============================================
POSTGRES_HOST=db
POSTGRES_PORT=5432
POSTGRES_DB=football_club_platform
POSTGRES_USER=app
POSTGRES_PASSWORD=changeme
DATABASE_URL=postgresql+asyncpg://app:changeme@db:5432/football_club_platform
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10
DB_ECHO=false

# ============================================
# REDIS (Cache & Queue)
# ============================================
REDIS_URL=redis://redis:6379/0
REDIS_MAX_CONNECTIONS=50
QUEUE_BACKEND=rq

# ============================================
# STORAGE
# ============================================
STORAGE_BACKEND=s3
STORAGE_LOCAL_PATH=/data/storage
UPLOAD_MAX_SIZE_MB=500

# S3/MinIO Configuration
S3_ENDPOINT_URL=http://minio:9000
S3_BUCKET=football-media
S3_ACCESS_KEY=minioadmin
S3_SECRET_KEY=minioadmin123
S3_REGION=eu-south-1
S3_USE_SSL=false

# ============================================
# VIDEO PROCESSING
# ============================================
ENABLE_GPU=false
POSE_BACKEND=mediapipe
VIDEO_KEYFRAME_SEC=2
VIDEO_PROCESS_TIMEOUT_SEC=1800
FFMPEG_THREADS=4
HEATMAP_FIELD_LENGTH_M=105
HEATMAP_FIELD_WIDTH_M=68

# ============================================
# MACHINE LEARNING
# ============================================
USE_NEW_MODEL=false
ML_MODEL_VERSION=1.0.0
ML_RETRAIN_MIN_SAMPLES=100
ML_DRIFT_PSI_WARN=0.1
ML_DRIFT_PSI_ALERT=0.25
ML_DRIFT_MAE_DEGRADE_THRESHOLD=0.2
ML_CALIBRATION_METHOD=isotonic
ML_SHAP_TIMEOUT_SEC=30

# PyTorch & Deep Learning
PYTORCH_ENABLE_CUDA=false
PYTORCH_DEVICE=cpu
TORCH_HOME=/app/.cache/torch
ONNX_RUNTIME_DEVICE=cpu
VIDEO_MODEL_PATH=/app/app/ml/model_store/video_detector.pt
VIDEO_MODEL_CONFIDENCE=0.5
VIDEO_MODEL_IOU_THRESHOLD=0.45

# Performance thresholds
PERF_THRESHOLD_LOW=45
PERF_THRESHOLD_HIGH=70

# ============================================
# REPORTS & PDF
# ============================================
PDF_BACKEND=weasyprint
PDF_LOCALE=it-IT
PDF_TIMEZONE=Europe/Rome
PDF_FOOTER_TEXT="Generated by Football Club Platform"
PDF_CACHE_HOURS=24
PDF_DPI=150
MATPLOTLIB_STYLE=seaborn-v0_8-darkgrid

# ============================================
# EMAIL / SMTP (Optional)
# ============================================
SMTP_ENABLED=false
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=noreply@example.com
SMTP_PASSWORD=change_me_strong_password
SMTP_USE_TLS=true
SMTP_FROM_NAME="Football Club Platform"
SMTP_FROM_EMAIL=noreply@example.com

# ============================================
# CRON / SCHEDULED JOBS
# ============================================
CRON_WEEKLY_STAFF_BRIEF="0 8 * * 1"
MODEL_RETRAIN_CRON="0 3 * * 1"
DRIFT_CHECK_CRON="0 4 * * *"
CACHE_CLEANUP_CRON="0 2 * * *"

# ============================================
# GDPR & PRIVACY
# ============================================
DATA_RETENTION_DAYS=1095
ANONYMIZE_EXPORTS=true
AUDIT_LOG_RETENTION_DAYS=2555
CONSENT_REQUIRED=true
MINOR_AGE_THRESHOLD=18

# ============================================
# SECURITY
# ============================================
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_BURST=100
BCRYPT_ROUNDS=12
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=lax
CORS_MAX_AGE=3600

# ============================================
# OBSERVABILITY
# ============================================
ENABLE_METRICS=true
METRICS_PORT=9090
SENTRY_DSN=
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1

# ============================================
# BENCHMARK (Anonymous Role/Age Data)
# ============================================
BENCHMARK_ENABLED=true
BENCHMARK_OPT_IN_DEFAULT=false
BENCHMARK_MIN_SAMPLES=10
BENCHMARK_CACHE_DAYS=7

# ============================================
# MULTI-TENANCY
# ============================================
TENANT_ISOLATION_STRICT=true
DEFAULT_TENANT_QUOTA_PLAYERS=50
DEFAULT_TENANT_QUOTA_STORAGE_GB=10

# ============================================
# FRONTEND (Next.js)
# ============================================
NEXT_PUBLIC_API_URL=http://localhost:8000
NEXT_PUBLIC_APP_NAME="Football Club Platform"
NEXT_PUBLIC_LOCALE=it-IT

# ============================================
# OPENTELEMETRY & DISTRIBUTED TRACING
# ============================================
OTEL_ENABLED=true
OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-collector:4317
OTEL_SERVICE_NAME=football_club_platform-api
OTEL_TRACES_EXPORTER=otlp
OTEL_METRICS_EXPORTER=otlp

# ============================================
# MLFLOW (Machine Learning Platform)
# ============================================
MLFLOW_TRACKING_URI=http://mlflow:5000
MLFLOW_EXPERIMENT_NAME=football_club_platform-injury-prediction
MLFLOW_REGISTRY_URI=

# ============================================
# GRAFANA (Monitoring Dashboards)
# ============================================
GRAFANA_PASSWORD=admin

# ============================================
# SEEDING
# ============================================
# SEED_PROFILE: Recommended (DEMO_10x10, FULL_DEV)
# DATASET: Legacy (minimal, staging, demo)
SEED_PROFILE=DEMO_10x10        # Options: DEMO_10x10, FULL_DEV (preferred over DATASET)
DATASET=minimal                # Legacy: minimal, staging, demo (use SEED_PROFILE instead)
SEED_ALLOW_PROD=false          # Set to true to allow seeding production
SEED_VERBOSE=true              # Enable verbose seed logging

# ============================================
# PRODUCTION CHECKLIST
# ============================================
# Before deploying to production:
# [ ] Set APP_ENV=production
# [ ] Set DEBUG=false
# [ ] Generate strong JWT_SECRET (32+ chars): openssl rand -hex 32
# [ ] Configure real S3 bucket (not MinIO)
# [ ] Set up HTTPS with valid SSL certificate
# [ ] Configure Sentry DSN for error tracking
# [ ] Set SMTP credentials for email notifications
# [ ] Configure database backups and retention
# [ ] Set appropriate CORS origins
# [ ] Review and adjust rate limits
# [ ] Enable RLS (TENANT_ISOLATION_STRICT=true)
# [ ] Set up monitoring alerts in Grafana
# [ ] VERIFY PORTS: Ensure no conflicts with port 3001 (pythonpro)
